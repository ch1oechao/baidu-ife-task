define(function(){function a(a){this.dom=a.dom,this.wrap=a.wrap,this.init()&&(this.renderDOM(),this.bindDom())}var b=function(a,b){for(var c=0;c<a.length;c++)b(a[c],c)},c=function(a,b){a.className?(newClassName=a.className,newClassName+=" ",newClassName+=b,a.className=newClassName):a.className=b},d=function(a,b){if(a.className==b)try{a.removeAttribute("class")}catch(c){a.className=""}},e=function(a){var b=a.split(" ");if(1===b.length){var c=b.toString();switch(c.substr(0,1)){case"#":return document.getElementById(c.substr(1));case".":if(document.getElementsByClassName)return document.getElementsByClassName(c.substr(1));var d=document.getElementsByTagName("*"),e=[];for(k=0;k<d.length;k++)f(d[k],c.substr(1))&&e.push(d[k]);return e;case"[":if("]"!==c.charAt(c.length-1))throw Error("']' is missing !");var g=c.substring(1,c.length-1),h=document.getElementsByTagName("*");if(-1!=g.indexOf("=")){for(var i=g.split("="),j=0;j<h.length;j++)if(h[j].getAttribute(i[0])===i[1])return h[j]}else for(var k=0;k<h.length;k++)if(h[k].hasAttribute(g))return h[k];break;default:return document.getElementsByTagName(c)}}else for(var l=1;l<b.length;k++)if("#"==b[0].substr(0,1)){var m=document.getElementById(b[0].substr(1));switch(b[l].substr(0,1)){case".":return m.getElementsByClassName(b[l].substr(1))[0];default:return m.getElementsByTagName(b[l])}}else if("."==b[0].substr(0,1)){var n=document.getElementsByClassName(b[0].substr(1));switch(b[l].substr(0,1)){case"#":return n.getElementById(b[l].substr(1));default:return m.getElementsByTagName(b[l])}}},f=function(a,b){for(var c=a.className.split(/\s+/),d=0;d<c.length;d++)if(c[d]==b)return!0;return!1},g=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},h=function(a,b){a.addEventListener?a.addEventListener("click",b,!1):a.attachEvent?a.attachEvent("onclick",b):a.onclick=b},i=function(a){a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0},j=function(a){return a&&a.preventDefault?a.preventDefault():window.event.returnValue=!1,!1},k=function(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c])},l=function(a,b){for(var c=0,d=a.length;d>c;c++)h(a[c],b)},m=function(a,b){for(var e=a.parentNode.children,f=0,g=e.length;g>f;f++)d(e[f],b);c(a,b)};Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1},Array.prototype.remove=function(a){var b=this.indexOf(a);b>-1&&this.splice(b,1)},a.prototype.init=function(){return this.idx=0,this.innerW=window.innerWidth,this.innerW<=768?!0:!1},a.prototype.renderDOM=function(){var a=this.innerW,c=this.dom,d=this.wrap;768>=a&&(d.style.width=a+"px",b(c,function(b,c){b.style.width=a+"px",b.style.display="inline-block",b.style.position="absolute",b.style.webkitTransform="translate3d("+a*c+"px,0,0)"}))},a.prototype.goIndex=function(a){var b=this.idx,c=this.dom,d=this.dom.length,f=0;"number"==typeof a?f=a:"string"==typeof a&&(f=b+1*a),f>d-1?f=d-1:0>f&&(f=0),this.idx=f,c[f].style.webkitTransition="-webkit-transform .3s ease-out",c[f-1]&&(c[f-1].style.webkitTransition="-webkit-transform .3s ease-out"),c[f+1]&&(c[f+1].style.webkitTransition="-webkit-transform .3s ease-out"),c[f].style.webkitTransform="translate3d(0, 0, 0)";for(var g=0;f>g;g++)c[g]&&(c[g].style.webkitTransform="translate3d(-"+this.innerW+"px, 0, 0)");for(var h=f+1;d>h;h++)c[h]&&(c[h].style.webkitTransform="translate3d("+this.innerW+"px, 0, 0)");var i=e(".todo-nav")[0],j=i.getElementsByTagName("ul")[0];switch(f){case 0:j.style.borderTop="2px solid #7690B4";break;case 1:j.style.borderTop="2px solid #EBB74C";break;case 2:j.style.borderTop="2px solid #E8919F"}},a.prototype.bindDom=function(){var a=this,b=a.innerW,c=a.wrap,d=function(b){i(b),b=b||window.event;var c=b.target||b.srcElement;a.startTime=1*new Date,a.startX=b.touches[0].pageX,a.startY=b.touches[0].pageY,"SECTION"==c.nodeName&&(a.target=c)},e=function(c){i(c),a.offsetX=c.targetTouches[0].pageX-a.startX,a.offsetY=c.targetTouches[0].pageY-a.startY,a.offsetY<50&&Math.abs(a.offsetX)>15&&j(c);var d=a.dom,e=a.idx-1,f=d.length;for(e;f>e;e++)d[e]&&(d[e].style.webkitTransition="-webkit-transform 0s ease-out"),d[e]&&(d[e].style.webkitTransform="translate3d("+((e-a.idx)*b+a.offsetX)+"px, 0, 0)")},f=function(c){i(c);var d=b/12,e=1*new Date;e-a.startTime>150?a.offsetX>=d?a.goIndex("-1"):a.offsetX<0&&a.offsetX<-d?a.goIndex("+1"):a.goIndex("0"):a.startX<10?a.goIndex("-1"):a.startX>b-10?a.goIndex("+1"):a.goIndex(a.idx)};g(c,"touchstart",d),g(c,"touchmove",e),g(c,"touchend",f)};var n=function(a,b){for(var c="",d=0,e=0;e<a.length;e++){if(d+=null!=a[e].match(/[^\x00-\xff]/gi)?2:1,d>b)return alert("名称不能超过十位汉字！请重新想个简短的名字吧~"),init.addCateName.value="",!1;if(0==d)return alert("名称不能为空！快起个名字吧~"),init.addCateName.value="",!1;c+=a[e]}return c},o=function(a){var b=a.split("-"),c=parseInt(b[0]),d=parseInt(b[1]-1),e=parseInt(b[2]),f=new Date,g=new Date(c,d,e);return f>g?(alert("任务完成日期太超前啦"),!1):g},p=function(a){for(var b=new RegExp("[$*()=|'\\[\\].<>/@#&{}]"),c="",d=0;d<a.length;d++)c+=a.substr(d,1).replace(b,"");return c},q=function(a,b,c){var d=/^(\d{4})\-(\d{2})\-(\d{2})$/;if(""==a.value||""==b.value||""==c.value)return alert("请仔细检查任务，查看是否填写完整~"),!1;if(!n(a.value,20))return!1;var e=p(n(a.value,20));if(!d.test(b.value)||!o(b.value))return!1;var f=o(b.value);if(!c.value)return!1;var g=p(c.value);return[e,f,g]},r=function(a){return function(b,c){var d=b[a],e=c[a];return e>d?-1:d>e?1:0}},s=function(a){var b=new Date(a.time);if(b){var c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate();return 10>d&&(d="0"+d),10>e&&(e="0"+e),[c,d,e].join("-")}};return{formatTime:s,compare:r,checkTask:q,checkXSS:p,getByteVal:n,silder:new a({dom:e("section"),wrap:e(".todo-container")[0]}),delegateInitClass:m,delegateClickEvent:l,delegateEleEvent:k,stopBubble:i,addClickEvent:h,addEvent:g,hasClass:f,$:e,removeClass:d,addClass:c,each:b}});